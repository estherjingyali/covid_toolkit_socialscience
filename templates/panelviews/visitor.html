{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>社会研究结果展示</title>
    <style>
     d{
            background-color: transparent;
            width: 300px;
            height: 300px;

            display: flex; /**/
            justify-content: center;
            align-items: Center;
        }
    </style>
</head>
<body>
<div class="ui large top fixed inverted menu">
    <div class="ui container">
        <a href="{% url 'index' %}" class="item">Visualization Panel</a>
    </div>
    <div class="right menu">
        <div class="ui item">
            <a href="{% url 'login' %}" class="item">Sign In</a>
            <span>|</span>
            <a href="{% url 'register' %}" class="item">Sign Up</a>
        </div>
    </div>
</div>

</div>
<div class="d" title="近期社会研究可视化展示"></div>
 <div class="chart-box" style="margin-left: 330px;margin-top:60px;margin-bottm:10px">
     <div id="calheat" style="width:70%;height:280%;"></div>
     <h6 align="center">截至5月21日数据，上海市新型冠状病毒感染病例累计确诊人数已达62658例。<br/>上海市3月28日开始分批实施封控管理，5月1日起开始有序进行社区解封。</h6>
 </div>
<div class="chart-box" style="margin-left: 330px;margin-top:60px;margin-bottm:10px">
    <div id="main" style="width:70%;height:380%;"></div>
</div>
</body>
<script type="text/javascript" src="{% static '/js/jquery-3.3.1.min.js' %}"></script>
<script type="text/javascript" src="{% static '/js/layer/layer.min.js' %}"></script>
<script type="text/javascript" src="{% static '/js/layer/laydate/laydate.js' %}"></script>
<script type="text/javascript" src="{% static '/js/echarts.min.js' %}"></script>
<script type="text/javascript" src="{% static '/js/semantic.js' %}"></script>
<link rel="stylesheet" href="{% static '/css/semantic.min.css' %}">
<script type="text/javascript">
    $.ajaxSetup({
            data:{csrfmiddlewaretoken:'{{ csrf_token }}'}
        });
    $('document').ready(function () {
        $("body").css('visibility', 'visible');
        var localData = [$('#teacher').val(), $('#start').val() + '/' + $('#end').val(), $('#leader').val()];
        localStorage.setItem("data", localData);
        $('#conBtn').on('click', function () {
            localData = [$('#teacher').val(), $('#start').val() + '/' + $('#end').val(), $('#leader').val()];
            if (typeof (Storage) !== "undefined") {
                localStorage.setItem("data", localData);
                var arr = localStorage.getItem("data").split(',');
                $('#name_a').html(arr[0]);
                $('#date_a').html(arr[1]);
                $('#lea_a').html(arr[2]);
            }
        });
        $('#fangda').on('click', function () {
            if ($(this).siblings('ul').is(":hidden")) {
                $(this).addClass('active').siblings('ul').show();
            } else {
                $(this).removeClass('active').siblings('ul').hide();
            }
        });
    });
</script>
<script>
        var myChart = echarts.init(document.getElementById('calheat'));
        mydata=[['2022-01-01', 3121], ['2022-01-02', 3147], ['2022-01-03', 3176], ['2022-01-04', 3193], ['2022-01-05', 3213], ['2022-01-06', 3237], ['2022-01-07', 3269], ['2022-01-08', 3299], ['2022-01-09', 3325], ['2022-01-10', 3352], ['2022-01-11', 3372], ['2022-01-12', 3403], ['2022-01-13', 3435], ['2022-01-14', 3478], ['2022-01-15', 3502], ['2022-01-16', 3537], ['2022-01-17', 3554], ['2022-01-18', 3569], ['2022-01-19', 3583], ['2022-01-20', 3611], ['2022-01-21', 3633], ['2022-01-22', 3646], ['2022-01-23', 3668], ['2022-01-24', 3679], ['2022-01-25', 3689], ['2022-01-26', 3710], ['2022-01-27', 3717], ['2022-01-28', 3727], ['2022-01-29', 3737], ['2022-01-30', 3747], ['2022-01-31', 3765], ['2022-02-01', 3783], ['2022-02-02', 3792], ['2022-02-03', 3799], ['2022-02-04', 3806], ['2022-02-05', 3818], ['2022-02-06', 3826], ['2022-02-07', 3841], ['2022-02-08', 3850], ['2022-02-09', 3858], ['2022-02-10', 3870], ['2022-02-11', 3877], ['2022-02-12', 3886], ['2022-02-13', 3894], ['2022-02-14', 3900], ['2022-02-15', 3913], ['2022-02-16', 3922], ['2022-02-17', 3935], ['2022-02-18', 3953], ['2022-02-19', 3976], ['2022-02-20', 4003], ['2022-02-21', 4035], ['2022-02-22', 4084], ['2022-02-23', 4108], ['2022-02-24', 4167], ['2022-02-25', 4222], ['2022-02-26', 4265], ['2022-02-27', 4310], ['2022-02-28', 4350], ['2022-03-01', 4388], ['2022-03-02', 4430], ['2022-03-03', 4475], ['2022-03-04', 4502], ['2022-03-05', 4527], ['2022-03-06', 4562], ['2022-03-07', 4602], ['2022-03-08', 4631], ['2022-03-09', 4677], ['2022-03-10', 4720], ['2022-03-11', 4747], ['2022-03-12', 4761], ['2022-03-13', 4818], ['2022-03-14', 4839], ['2022-03-15', 4854], ['2022-03-16', 4877], ['2022-03-17', 4944], ['2022-03-18', 4964], ['2022-03-19', 4986], ['2022-03-20', 5027], ['2022-03-21', 5066], ['2022-03-22', 5080], ['2022-03-23', 5094], ['2022-03-24', 5135], ['2022-03-25', 5182], ['2022-03-26', 5233], ['2022-03-27', 5293], ['2022-03-28', 5400], ['2022-03-29', 5729], ['2022-03-30', 6087], ['2022-03-31', 6452], ['2022-04-01', 6714], ['2022-04-02', 7158], ['2022-04-03', 7591], ['2022-04-04', 7862], ['2022-04-05', 8177], ['2022-04-06', 8506], ['2022-04-07', 9334], ['2022-04-08', 10351], ['2022-04-09', 10351], ['2022-04-10', 12283], ['2022-04-11', 12283], ['2022-04-12', 14471], ['2022-04-13', 17044], ['2022-04-14', 20244], ['2022-04-15', 23838], ['2022-04-16', 27078], ['2022-04-17', 29498], ['2022-04-18', 32582], ['2022-04-19', 35077], ['2022-04-20', 37712], ['2022-04-21', 39643], ['2022-04-22', 42379], ['2022-04-23', 43780], ['2022-04-24', 46252], ['2022-04-25', 47913], ['2022-04-26', 49519], ['2022-04-27', 50811], ['2022-04-28', 50811], ['2022-04-29', 57550], ['2022-04-30', 58339], ['2022-05-01', 59068], ['2022-05-02', 59343], ['2022-05-03', 59605], ['2022-05-04', 59868], ['2022-05-05', 60113], ['2022-05-06', 60366], ['2022-05-07', 60583], ['2022-05-08', 60907], ['2022-05-09', 61141], ['2022-05-10', 61370], ['2022-05-11', 61514], ['2022-05-12', 61741], ['2022-05-13', 61936], ['2022-05-14', 62104], ['2022-05-15', 62174], ['2022-05-16', 62251], ['2022-05-17', 62348], ['2022-05-18', 62431], ['2022-05-19', 62521], ['2022-05-20', 62605], ['2022-05-21', 62658]]


        var option = {
             title: {
                 top: 30,
                 left: 'center',
                 text: 'CovidConfirmData in 2022 Shanghai'
  },
            tooltip: {},
            visualMap: {
                 min: 3000,
                max: 63000,
                type: 'piecewise',
                orient: 'horizontal',
                left: 'center',
                top: 65
            },
            calendar: {
                 top: 120,
                 left: 30,
                right: 30,
                cellSize: ['auto', 13],
                 range: ['2022-01-01','2022-05-21'],
                 itemStyle: {
                     borderWidth: 0.5
                 },
                yearLabel: { show: false }
            },
            series: {
                type: 'heatmap',
                coordinateSystem: 'calendar',
                data: mydata
            }
        };
        myChart.setOption(option);
</script>
<script>
var app = {};

var chartDom = document.getElementById('main');
var myChart = echarts.init(chartDom);
var option;

const posList = [
  'left',
  'right',
  'top',
  'bottom',
  'inside',
  'insideTop',
  'insideLeft',
  'insideRight',
  'insideBottom',
  'insideTopLeft',
  'insideTopRight',
  'insideBottomLeft',
  'insideBottomRight'
];
app.configParameters = {
  rotate: {
    min: -90,
    max: 90
  },
  align: {
    options: {
      left: 'left',
      center: 'center',
      right: 'right'
    }
  },
  verticalAlign: {
    options: {
      top: 'top',
      middle: 'middle',
      bottom: 'bottom'
    }
  },
  position: {
    options: posList.reduce(function (map, pos) {
      map[pos] = pos;
      return map;
    }, {})
  },
  distance: {
    min: 0,
    max: 100
  }
};
app.config = {
  rotate: 90,
  align: 'left',
  verticalAlign: 'middle',
  position: 'insideBottom',
  distance: 15,
  onChange: function () {
    const labelOption = {
      rotate: app.config.rotate,
      align: app.config.align,
      verticalAlign: app.config.verticalAlign,
      position: app.config.position,
      distance: app.config.distance
    };
    myChart.setOption({
      series: [
        {
          label: labelOption
        },
        {
          label: labelOption
        },
        {
          label: labelOption
        },
      ]
    });
  }
};
const labelOption = {
  show: true,
  position: app.config.position,
  distance: app.config.distance,
  align: app.config.align,
  verticalAlign: app.config.verticalAlign,
  rotate: app.config.rotate,
  formatter: '{c}  {name|{a}}',
  fontSize: 16,
  rich: {
    name: {}
  }
};
option = {
    title: {
        top: 30,
        left: 'center',
        text: '近一月疫情相关微博话题情感倾向得分柱状图'
  },
  tooltip: {
    trigger: 'axis',
    axisPointer: {
      type: 'shadow'
    }
  },
  legend: {
    data: ['积极', '消极', '中性']
  },
  toolbox: {
    show: true,
    orient: 'vertical',
    left: 'right',
    top: 'center',
    feature: {
      mark: { show: true },
      dataView: { show: true, readOnly: false },
      magicType: { show: true, type: ['line', 'bar', 'stack'] },
      restore: { show: true },
      saveAsImage: { show: true }
    }
  },
  xAxis: [
    {
      type: 'category',
      axisTick: { show: false },
      data: ['#北京疫情发布会#', '#北京今日出现突发疫情#', '#北京本轮疫情已得到有效控制#', '#上海核酸#', '#上海回来了#','#上海恢复后外滩等地出现拥堵#','疫情催生的超能力有多绝']
    }
  ],
  yAxis: [
    {
      type: 'value'
    }
  ],
  series: [
    {
      name: '积极',
      type: 'bar',
      barGap: 0,
      label: labelOption,
      emphasis: {
        focus: 'series'
      },
      data: [3600,4966,4632,2720,1045,1585,828]
    },
    {
      name: '消极',
      type: 'bar',
      label: labelOption,
      emphasis: {
        focus: 'series'
      },
      data: [893,1110,1105,872,212,480,130]
    },
    {
      name: '中性',
      type: 'bar',
      label: labelOption,
      emphasis: {
        focus: 'series'
      },
      data: [293,395,409,257,62,105,69]
    },
  ]
};

option && myChart.setOption(option);
</script>
</html>